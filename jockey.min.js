!function(i){"use strict";var t=-1,s=!1,h=function(i,t,s){var h=i[t];return i[t]=i[s],i[s]=h,i},e=function(i,t){return Math.floor(Math.random()*(t-i+1))+i},n=function(i){return this instanceof n?(this.items=i||[],this.shuffled=s,this.i=t,void(this.repeatFlag=!1)):new n(i)},f=n.prototype;f.add=function(i){if(null==i)throw new Error("need an item");this.items.push(i),this.isShuffling()&&(this.shuffled.push(i),this._s(this.shuffled,this.isPlaying()?this.i+1:0))},f.remove=function(i){this._c(i);var t=this.getCurrent(),s=this.items[i];return this.items.splice(i,1),this.isShuffling()&&(i=this.shuffled.indexOf(s),this.shuffled.splice(i,1)),i<this.i?void this.i--:void(s==t&&this.stop())},f.size=function(){return this.items.length},f.get=function(i){return null==i?this.items:(this._c(i),this.items[i])},f.getCurrentIndex=function(){return this.isPlaying()?this.isShuffling()?this.items.indexOf(this.getCurrent()):this.i:t},f.getCurrent=function(){return this.isPlaying()?this.isShuffling()?this.shuffled[this.i]:this.items[this.i]:null},f.isPlaying=function(){return this.i!==t},f.play=function(i){this._c(i||0),null==i?this.i=0:this.isShuffling()?(this.shuffled=this.items.slice(),h(this.shuffled,0,i),this._s(this.shuffled,1),this.i=0):this.i=i},f.stop=function(){this.isShuffling()&&this._r(),this.i=t},f.repeat=function(){this.repeatFlag=!this.repeatFlag},f.isRepeating=function(){return this.repeatFlag},f.shuffle=function(){if(this.isShuffling())this.isPlaying()&&(this.i=this.getCurrentIndex()),this.shuffled=s;else if(this.isPlaying()){this.shuffled=this.items.slice();var i=this.shuffled[this.i];this.shuffled[this.i]=this.shuffled[0],this.shuffled[0]=i,this._s(this.shuffled,1),this.i=0}else this._r()},f.isShuffling=function(){return this.shuffled!==s},f.previous=function(){var i=this.items.length;if(this.isPlaying()&&i){if(this.i>0)return void this.i--;if(!this.isRepeating())return this.stop();if(this.isShuffling()){var t=this.getCurrent();if(this._r(),i>1&&this.shuffled[i-1]===t){var s=e(0,this.items.length-2);h(this.shuffled,i-1,s)}}this.i=i-1}},f.next=function(){var i=this.items.length;if(this.isPlaying()&&i){if(this.i<i-1)return void this.i++;if(!this.isRepeating())return this.stop();if(this.isShuffling()){var t=this.getCurrent();if(this._r(),i>1&&this.shuffled[0]===t){var s=e(1,this.items.length-1);h(this.shuffled,0,s)}}this.i=0}},f.reorder=function(i,t){this._c(i),this._c(t);var s=this.items.splice(i,1)[0];if(this.items.splice(t,0,s),this.isPlaying()&&!this.isShuffling()){if(this.i===i)return void(this.i=t);i<=this.i&&t>=this.i?this.i--:i>=this.i&&t<=this.i&&this.i++}},f._c=function(i,t){if(0>i||i>=(t||this.items.length))throw new Error("invalid index: "+i)},f._r=function(){this.shuffled=this.items.slice(),this._s(this.shuffled,0)},f._s=function(i,t){t=t||0;for(var s=i.length-1;s>t;){var e=Math.max(t,Math.floor(Math.random()*(s+1)));h(i,s,e),s--}return i},"object"==typeof module?module.exports=n:i.jockey=n}(this);